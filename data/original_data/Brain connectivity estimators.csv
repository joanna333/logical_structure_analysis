Title,Content
Brain connectivity estimators,"Brain connectivity estimators represent patterns of links in the brain. Connectivity can be considered at different levels of the brain's organisation: from neurons, to neural assemblies and brain structures. Brain connectivity involves different concepts such as: neuroanatomical or structural connectivity (pattern of anatomical links), functional connectivity (usually understood as statistical dependencies) and effective connectivity (referring to causal interactions).
Neuroanatomical connectivity is inherently difficult to define given the fact that at the microscopic scale of neurons, new synaptic connections or elimination of existing ones are formed dynamically and are largely dependent on the function executed, but may be considered as pathways extending over regions of the brain, which are in accordance with general anatomical knowledge. Diffusion Weighted Imaging (DWI) can be used to provide such information.  
The distinction between functional and effective connectivity is not always sharp; sometimes causal or directed connectivity is called functional connectivity. Functional connectivity, may be defined as the temporal correlation (in terms of statistically significant dependence between distant brain regions) among the activity of different neural assemblies, whereas effective connectivity may be defined as the direct or indirect influence that one neural system exerts over another.
Some brain connectivity estimators evaluate connectivity from brain activity time series such as Electroencephalography (EEG), Local field potential (LFP) or spike trains, with an effect on the directed connectivity. These estimators can be applied to fMRI data, if the required image sequences are available.
Among estimators of connectivity, there are linear and non-linear, bivariate and multivariate measures. Certain estimators also indicate directionality. Different methods of connectivity estimation vary in their effectiveness. This article provides an overview of these measures, with an emphasis on the most effective methods.


== Bi-variate estimators ==


=== Classical methods ===
Classical estimators of connectivity are correlation and coherence. The above measures provide information on the directionality of interactions in terms of delay (correlation) or coherence (phase), however the information does not imply causal interaction. Moreover, it may be ambiguous, since phase is determined modulo 2π. It is also not possible to identify by means of correlation or coherence.


=== Non-linear methods ===
The most frequently used nonlinear estimators of connectivity are mutual information, transfer entropy, generalised synchronisation, the continuity measure, synchronization likelihood, and phase synchronization. Mutual information and transfer entropy rely on the construction of histograms for probability estimates. The continuity measure, generalized synchronisations, and synchronisation likelihood are very similar methods based on phase space reconstruction. Among these measures, only transfer entropy allows for the determination of directionality. Nonlinear measures require long stationary segments of signals, are prone to systematic errors, and above all are very sensitive to noise. The comparison of nonlinear methods with linear correlation in the presence of noise reveals the poorer performance of non-linear estimators. In  the authors conclude that there must be good reason to think that there is non-linearity in the data to apply non-linear methods. In fact it was demonstrated by means of surrogate data test, and time series forecasting  that nonlinearity in EEG and LFP is the exception rather than the norm. On the other hand, linear methods perform quite well for non-linear signals. Finally, non-linear methods are bivariate (calculated pair-wise), which has serious implication on their performance.


== Bivariate versus multivariate estimators ==
Comparison of performance of bivariate and multivariate estimators of connectivity may be found in, where it was demonstrated that in case of interrelated system of channels, greater than two, bivariate methods supply misleading information, even reversal of true propagation may be found.
Consider the very common situation that the activity from a given source is measured at electrodes positioned at different distances, hence different delays between the recorded signals.
When a bivariate measure is applied, propagation is always obtained when there is a delay between channels., which results in a lot of spurious flows. When we have two or three sources acting simultaneously, which is a common situation, we shall get dense and disorganized structure of connections, similar to random structure (at best some ""small world"" structure may be identified). This kind of pattern is usually obtained in case of application of bivariate measures. In fact, effective connectivity patterns yielded by EEG or LFP measurements are far from randomness, when proper multivariate measures are applied, as we shall demonstrate below.


== Multivariate methods based on Granger causality ==
The testable definition of causality was introduced by Granger. Granger causality principle states that if some series Y(t) contains information in past terms that helps in the prediction of series X(t), then Y(t) is said to cause X(t). Granger causality principle can be expressed in terms of two-channel multivariate autoregressive model (MVAR). Granger in his later work  pointed out that the determination of causality is not possible when the system of considered channels is not complete.
The measures based on Granger causality principle are: Granger Causality Index (GCI), Directed Transfer Function (DTF) and Partial Directed Coherence (PDC). These measures are defined in the framework of Multivariate Autoregressive Model.


=== Multivariate Autoregressive Model ===
The AR model assumes that X(t)—a sample of data at a time t—can be expressed as a sum of p previous values of the samples from the set of k-signals weighted by model coefficients A plus a random value E(t):

The p is called the model order. For a k-channel process X(t) and E(t) are vectors of size k and the coefficients A are k×k-sized matrices.
The model order may be determined by means of criteria developed in the framework of information theory and the coefficients of the model are found by means of the minimalization of the residual noise. In the procedure correlation matrix between signals is calculated.
By the transformation to the frequency domain we get:

H(f) is a transfer matrix of the system, it contains information about the relationships between signals and their spectral characteristics. H(f) is non-symmetric, so it allows for finding causal dependencies.
Model order may be found by means of criteria developed in the framework of information theory, e.g. AIC criterion.


=== Granger Causality Index ===
Granger causality index showing the driving of channel x by channel y is defined as the logarithm of the ratio of residual variance for one channel to the residual variance of the two-channel model:
GCIy→x = ln (e/e1) 
This definition can be extended to the multichannel system by considering how the inclusion of the given channel changes the residual variance ratios. To quantify directed influence from a channel xj to xi for n channel autoregressive process in time domain we consider n and n−1 dimensional MVAR models. First, the model is fitted to whole n-channel system, leading to the residual variance Vi,n(t) = var(Ei,n(t)) for signal xi. Next, a n−1 dimensional MVAR model is fitted for n−1 channels, excluding channel j, which leads to the residual variance Vi,n−1(t) = var (Ei,n−1(t)). Then Granger causality is defined as:

  
    
      
        
          
            G
            C
            I
          
          
            j
            →
            i
          
        
        (
        t
        )
        =
        ln
        ⁡
        
          (
          
            
              
                
                  V
                  
                    i
                    ,
                    n
                  
                
                (
                t
                )
              
              
                
                  V
                  
                    i
                    ,
                    n
                    −
                    1
                  
                
                (
                t
                )
              
            
          
          )
        
      
    
    {\displaystyle \mathrm {GCI} _{j\rightarrow i}(t)=\ln \left({\frac {V_{i,n}(t)}{V_{i,n-1}(t)}}\right)}
  

GCI is smaller or equal 1, since the variance of n-dimensional system is lower than the residual variance of a smaller, n−1 dimensional system. 
GCI(t) estimates causality relations in time domain. For brain signals the spectral characteristics of the signals is of interest, because for a given task the increase of propagation in certain frequency band may be accompanied by the decrease in another frequency band. DTF or PDC are the estimators defined in the frequency domain.


=== Directed Transfer Function ===
Directed Transfer Function (DTF) was introduced by Kaminski and Blinowska  in the form:

Where Hij(f) is an element of a transfer matrix of MVAR model.
DTF describes causal influence of channel j on channel i at frequency f. The above equation (3) defines a normalized version of DTF, which takes values from 0 to 1 producing a ratio between the inflow from channel j to channel i to all the inflows to channel i. 
The non-normalized DTF which is directly related to the coupling strength  is defined as:

DTF shows not only direct, but also cascade flows, namely in case of propagation 1→2→3 it shows also propagation 1→3. In order to distinguish direct from indirect flows direct Directed Transfer Function (dDTF) was introduced. 
The dDTF is defined as a multiplication of a modified DTF by partial coherence. The modification of DTF concerned normalization of the function in such a way as to make the denominator independent of frequency. The dDTFj→i showing direct propagation from channel j to i is defined as:

Where Cij(f) is partial coherence. The dDTFj→i has a nonzero value when both functions Fij(f) and Cij(f) are non-zero, in that case there exists a direct causal relation between channels j→i. 
Distinguishing direct from indirect transmission is essential in case of signals from implanted electrodes, for EEG signals recorded by scalp electrodes it is not really important.
DTF may be used for estimation of propagation in case of point processes e.g. spike trains or for the estimation of causal relations between spike trains and Local Field Potentials.


=== Partial Directed Coherence ===
The partial directed coherence (PDC) was defined by Baccala and Sameshima  in the following form:

In the above equation Aij(f) is an element of A(f)—a Fourier transform of MVAR model coefficients A(t), where aj(f) is j-th column of A(f) and the asterisk denotes the transpose and complex conjugate operation. Although it is a function operating in the frequency domain, the dependence of A(f) on the frequency has not a direct correspondence to the power spectrum. From normalization condition it follows that PDC takes values from the interval [0,1]. PDC shows only direct flows between channels. Unlike DTF, PDC is normalized to show a ratio between the outflow from channel j to channel i to all the outflows from the source channel j, so it emphasizes rather the sinks, not the sources. The normalization of PDC affects the detected intensities of flow as was pointed out in. Namely, adding further variables that are influenced by a source variable decreases PDC, although the relationship between source and target processes remains unchanged. In other words: the flow emitted in one direction will be enhanced in comparison to the flows of the same intensity emitted from a given source in several directions.


== Time-varying estimators of effective connectivity ==
In order to account for the dynamic changes of propagation, the method of adaptive filtering or the method based on the sliding window may be applied to estimators of connectivity. Both methods require multiple repetition of the experiment to obtain statistically satisfactory results and they produce similar results. The adaptive methods, e.g. Kalman filtering, are more computationally demanding, therefore methods based on sliding window may be recommended.
In the case of parametric model the number of data points kNT (k—number of channels, NT—number of points in the data window) has to be bigger (preferably by order of magnitude) than the number of parameters, which in case of MVAR is equal to k2p (p—model order). In order to evaluate dynamics of the process, a short data window has to be applied, which requires an increase of the number of the data points, which may be achieved by means of a repetition of the experiment. A non-stationary recording may be divided into shorter time windows, short enough to treat the data within a window as quasi-stationary. Estimation of MVAR coefficients is based on calculation of the correlation matrix between channels Rij of k signals Xi from multivariate set, separately for each trial. The resulting model coefficients are based on the correlation matrix averaged over trials. The correlation matrix has the form:

The averaging concerns correlation matrices (model is fitted independently for each short data window); the data are not averaged in the process. The choice of window size is always a compromise between quality of the fit and time resolution.
The errors of the SDTF may be evaluated by means of bootstrap method. This procedure corresponds to simulations of other realizations of the experiment. The variance of the function value is obtained by repeated calculation of the results for a randomly selected (with repetitions) pool of the original data trials.


== Applications ==
The estimation of brain connectivity has found numerous and notable applications, namely when investigating brain changes associated with the treatment of psychopathology like schizophrenia and depression, or following structural damage like in hemorrhage or tumor. The methods applied benefit from a parcellation approach, where regions of the brain are defined from atlases or DWI data, with connectivity metrics then extracted to compare changes within standardized regions.
Specifically, DTF found multiple applications, the early ones involved: localization of epileptic foci, estimation of EEG propagation in different sleep stages and wakefulness, determination of transmission between brain structures of an animal during a behavioral test.
One may observe the shifting of sources toward the front in transition from wakefulness to the deeper sleep stages. In the deep sleep the source is over corpus callosum, presumably it is connected with feeding the cortex from the sub-cortical structures.
One of the first applications of SDTF was determination of the dynamic propagation during performance of finger movement and its imagination,. The results corresponded very well with the known phenomena of event related synchronization and desynchronization such as decrease of the activity in alpha and beta band and brief increase of activity in the gamma band during movement in the areas corresponding to primary motor cortex, beta rebound after movement and so-called surround effect. Especially interesting was comparison of real finger movement and its imagination. In case of real movement the short burst of gamma propagation was observed from the electrode positioned over finger primary motor cortex . In case of movement imagination this propagation started later and a cross-talk between different sites overlying motor area and supplementary motor area (SMA) was found. (The dynamics of propagation may be observed in animations).
Another applications of SDTF concerned evaluation of transmission during cognitive experiments. The results of the Continuous Attention Test (CAT)  confirmed the engagement of prefrontal and frontal structures in the task and supported the hypothesis of an active inhibition by pre-SMA and right inferior frontal cortex. Animations of propagation during CAT test are available.
The results obtained by means of SDTF in experiments involving working memory were compatible with fMRI studies on the localization of the active sites and supplied the information concerning the temporal interaction between them. The animation illustrating dynamics of the interaction are available.
Note that care should be taken to avoid spurious connectivity estimates when using EEG channel data. Recent articles highlight that previous claims that DTF and PDC were insensitive to volume conduction were inaccurate. Indeed, DTF results obtained for signals recorded from the scalp are in general affected by volume conduction. Even though the effects of volume conduction might be minimal in specific recording situations, appropriate preprocessing on channel data (such as source identification) should be performed before estimating DTF or PDC.


== Conclusions ==
The existence of well defined sources of brain activity connected with particular experimental conditions are well established in fMRI experiments, by means of inverse solution methods and intracortical measurements. This kind of deterministic structure of brain activity should affect functional connectivity, so reported in some works random or barely distinguished from random connectivity structure may be considered as a surprising phenomenon. This kind of results may be explained by methodological errors: 1) unrobust methods of connectivity estimation and, even more important, 2) application of bivariate methods. When multivariate robust measures of connectivity are applied for EEG analysis a clear picture of functional connectivity emerges.


== See also ==
Resting State fMRI
Dynamic Functional Connectivity
List of Functional Connectivity Software
Synapse


== References ==


== External links ==
SCoT - Python toolbox for source connectivity estimation
SIFT - MATLAB-based toolbox for source connectivity estimation based on EEGLAB
Connectome
HERMES - MATLAB toolbox for functional and effective brain connectivity estimation for M/EEG"
